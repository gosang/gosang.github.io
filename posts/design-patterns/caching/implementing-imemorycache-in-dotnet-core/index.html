<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en-us lang=en-us><head><script defer language=javascript type=text/javascript src=/js/bundle.min.11d62625e7495f8147fccf5d08f37bded574a50c4508c235cc666848567d99ab.js></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=/favicon.png><title itemprop=name>Go Sang - Implementing In-Memory Caching in .NET Core with IMemoryCache</title><meta property="og:title" content="Go Sang - Implementing In-Memory Caching in .NET Core with IMemoryCache"><meta name=twitter:title content="Go Sang - Implementing In-Memory Caching in .NET Core with IMemoryCache"><meta itemprop=name content="Go Sang - Implementing In-Memory Caching in .NET Core with IMemoryCache"><meta name=application-name content="Go Sang - Implementing In-Memory Caching in .NET Core with IMemoryCache"><meta property="og:site_name" content><meta name=description content><meta itemprop=description content><meta property="og:description" content><meta name=twitter:description content><base href=https://gosang.github.io/posts/design-patterns/caching/implementing-imemorycache-in-dotnet-core/><link rel=canonical href=https://gosang.github.io/posts/design-patterns/caching/implementing-imemorycache-in-dotnet-core/ itemprop=url><meta name=url content="https://gosang.github.io/posts/design-patterns/caching/implementing-imemorycache-in-dotnet-core/"><meta name=twitter:url content="https://gosang.github.io/posts/design-patterns/caching/implementing-imemorycache-in-dotnet-core/"><meta property="og:url" content="https://gosang.github.io/posts/design-patterns/caching/implementing-imemorycache-in-dotnet-core/"><meta property="og:updated_time" content="14006-14-08T643:48:22Z"><link rel=sitemap type=application/xml title=Sitemap href=https://gosang.github.io/sitemap.xml><meta name=robots content="index,follow"><meta name=googlebot content="index,follow"><meta name=twitter:site content><meta name=twitter:creator content><meta property="fb:admins" content><meta name=apple-mobile-web-app-title content><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black"><meta property="og:type" content="article"><meta property="article:publisher" content><meta property="og:article:published_time" content="14006-14-08T643:48:22Z"><meta property="article:published_time" content="14006-14-08T643:48:22Z"><script defer type=application/ld+json>{"@context":"http://schema.org","@type":"Article","headline":"Implementing In-Memory Caching in .NET Core with IMemoryCache","author":{"@type":"Person","name":"https:\/\/github.com\/gosang"},"datePublished":"2022-06-14","description":"","wordCount":"602","mainEntityOfPage":"True","dateModified":"2022-06-14","image":{"@type":"imageObject","url":""},"publisher":{"@type":"Organization","name":"","logo":{"@type":"imageObject","url":""}}}</script><meta name=generator content="Hugo 0.119.0"><link type=text/css rel=stylesheet href=/css/bundle.min.178e339ccb9acabffeebf9adbb0bb23c1ec0b72a2a50edee18a5007d4d5a68aa.css><style>body{--sidebar-bg-color:#202020;--sidebar-img-border-color:#515151;--sidebar-p-color:#909090;--sidebar-h1-color:#FFF;--sidebar-a-color:#FFF;--sidebar-socials-color:#FFF;--text-color:#222;--bkg-color:#FAF9F6;--post-title-color:#303030;--list-color:#5a5a5a;--link-color:#268bd2;--date-color:#515151;--table-border-color:#E5E5E5;--table-stripe-color:#F9F9F9;--code-color:#bf616a;--code-background-color:#E5E5E5;--moon-sun-color:#FFF;--moon-sun-background-color:#515151}body.dark-theme{--text-color:#eee;--bkg-color:#121212;--post-title-color:#DBE2E9;--list-color:#9d9d9d;--link-color:#268bd2;--date-color:#9a9a9a;--table-border-color:#515151;--table-stripe-color:#202020;--code-color:#ff7f7f;--code-background-color:#393D47}body{background-color:var(--bkg-color)}</style></head><body><div class=wrapper><aside class=sidebar><div class="container sidebar-sticky"><div class=light-dark align=right><button class=btn-light-dark title="Toggle light/dark mode"><svg class="moon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16"><path fill="currentcolor" d="M6 .278a.768.768.0 01.08.858 7.208 7.208.0 00-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527.0 1.04-.055 1.533-.16a.787.787.0 01.81.316.733.733.0 01-.031.893A8.349 8.349.0 018.344 16C3.734 16 0 12.286.0 7.71.0 4.266 2.114 1.312 5.124.06A.752.752.0 016 .278z"/></svg><svg class="sun" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16"><path fill="currentcolor" d="M8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0zm0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13zm8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5zM3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8zm10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0zm-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0zm9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707zM4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708z"/></svg></button></div><div class=sidebar-about><h1 class=brand><a href=https://gosang.github.io/><h1>Go Sang</h1></a></h1><p class=lead>Learning about technology.</p></div><nav><ul class=sidebar-nav><li class=heading><a href=/posts/>Posts</a></li><li class=sub-heading>Recent</li><li class=bullet><a href=https://gosang.github.io/posts/react/simplifying-the-nextjs-server-actions/>Simplifying the Next.js Server Actions</a></li><li class=bullet><a href=https://gosang.github.io/posts/dotnet/result-pattern-in-asp-dotnet-core/>Result Pattern in ASP.NET Core</a></li><li class=bullet><a href=https://gosang.github.io/posts/dotnet/simplifying-cors-in-asp-dotnet-core-api/>Simplifying CORS in ASP.NET Core API</a></li><li class=bullet><a href=https://gosang.github.io/posts/dotnet/using-hangfire-with-asp-dotnet-core-and-worker-services/>Using Hangfire with ASP.NET Core and Worker Services</a></li><li class=bullet><a href=https://gosang.github.io/posts/security/simplifying-cookie-based-and-token-based-authentication/>Simplifying Cookie-based and Token-based Authentication</a></li></ul></nav><a target=_blank class=social title=GitHub href=https://github.com/gosang><svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="-2 -2 24 24"><path fill="currentcolor" d="M18.88 1.099C18.147.366 17.265.0 16.233.0H3.746C2.714.0 1.832.366 1.099 1.099.366 1.832.0 2.714.0 3.746v12.487c0 1.032.366 1.914 1.099 2.647.733.733 1.615 1.099 2.647 1.099H6.66c.19.0.333-.007.429-.02a.504.504.0 00.286-.169c.095-.1.143-.245.143-.435l-.007-.885c-.004-.564-.006-1.01-.006-1.34l-.3.052c-.19.035-.43.05-.721.046a5.555 5.555.0 01-.904-.091 2.026 2.026.0 01-.872-.39 1.651 1.651.0 01-.572-.8l-.13-.3a3.25 3.25.0 00-.41-.663c-.186-.243-.375-.407-.566-.494l-.09-.065a.956.956.0 01-.17-.156.723.723.0 01-.117-.182c-.026-.061-.004-.111.065-.15.07-.04.195-.059.378-.059l.26.04c.173.034.388.138.643.311a2.1 2.1.0 01.631.677c.2.355.44.626.722.813.282.186.566.28.852.28.286.0.533-.022.742-.065a2.59 2.59.0 00.585-.196c.078-.58.29-1.028.637-1.34a8.907 8.907.0 01-1.333-.234 5.314 5.314.0 01-1.223-.507 3.5 3.5.0 01-1.047-.872c-.277-.347-.505-.802-.683-1.365-.177-.564-.266-1.215-.266-1.952.0-1.049.342-1.942 1.027-2.68-.32-.788-.29-1.673.091-2.652.252-.079.625-.02 1.119.175.494.195.856.362 1.086.5.23.14.414.257.553.352a9.233 9.233.0 012.497-.338c.859.0 1.691.113 2.498.338l.494-.312a6.997 6.997.0 011.197-.572c.46-.174.81-.221 1.054-.143.39.98.424 1.864.103 2.653.685.737 1.028 1.63 1.028 2.68.0.737-.089 1.39-.267 1.957-.177.568-.407 1.023-.689 1.366a3.65 3.65.0 01-1.053.865c-.42.234-.828.403-1.223.507a8.9 8.9.0 01-1.333.235c.45.39.676 1.005.676 1.846v3.11c0 .147.021.266.065.357a.36.36.0 00.208.189c.096.034.18.056.254.064.074.01.18.013.318.013h2.914c1.032.0 1.914-.366 2.647-1.099.732-.732 1.099-1.615 1.099-2.647V3.746c0-1.032-.367-1.914-1.1-2.647z"/></svg></a><a target=_blank class=social title="RSS Feed" href=https://gosang.github.io//posts/index.xml><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 1280 1280"><g transform="translate(0.000000,1280.000000) scale(0.100000,-0.100000)" fill="currentcolor"><path d="M2295 11929c-284-12-642-45-707-65-17-5-18-63-18-1039 0-569 4-1036 8-1039 5-3 74 6 153 19 510 86 1168 95 1789 25 1348-153 2602-677 3670-1531 385-308 820-744 1126-1129 842-1060 1362-2313 1514-3650 70-621 61-1279-25-1789-13-79-22-148-19-153 3-4 471-8 1039-8h1035l5 23c51 225 85 942 67 1419-23 605-77 1044-198 1617-294 14e2-927 2734-1823 3846-1043 1295-2364 2259-3909 2854-1158 447-2451 656-3707 6e2z"/><path d="M2255 7845c-269-25-620-81-667-106-17-9-18-55-18-899 0-706 3-890 13-890 6 0 66 18 132 41 130 44 288 79 467 105 154 21 577 30 749 15 1207-107 2267-823 2814-1902 166-327 268-637 330-1001 38-227 48-384 42-662-8-348-44-590-126-831-23-66-41-126-41-132 0-10 184-13 890-13 844 0 890 1 899 18 27 50 88 452 110 725 14 162 14 624 1 782-59 703-233 1323-545 1945-481 956-1313 1788-2270 2268-620 310-1239 483-1940 542-165 14-669 10-840-5z"/><path d="M2519 3815c-391-66-725-336-868-703-79-201-96-462-45-677 83-344 338-641 666-774 116-47 205-69 330-80 412-39 811 153 1040 5e2 193 292 240 648 128 981-135 403-492 699-914 757-1e2 14-241 12-337-4z"/></g></svg></a><p class=footnote>powered by <a target=_blank href=https://gohugo.io>Hugo</a> | themed with <a target=_blank href=https://github.com/lukeorth/poison>poison</a><br>&copy; 2024 . All rights reserved.</p></div></aside><main class="content container"><div class=post><div class=info><h1 class=post-title><a href=https://gosang.github.io/posts/design-patterns/caching/implementing-imemorycache-in-dotnet-core/>Implementing In-Memory Caching in .NET Core with IMemoryCache</a></h1><time datetime=2022-06-14T08:43:48Z class=post-date>June 14, 2022</time><ul class=tags><li class=tag-IMemoryCache><a href=https://gosang.github.io/tags/imemorycache>IMemoryCache</a></li></ul><p class=seriesname>Series: <a href=https://gosang.github.io/series/caching>Caching</a></p></div><p>Caching is a fundamental technique in software development to improve application performance and responsiveness. In the context of .NET Core, one powerful tool for implementing caching is the IMemoryCache interface. In this blog post, we will explore what In-Memory Caching is, the rationale behind using it with IMemoryCache, its implementation in an e-commerce system using .NET Core, and compare its advantages with Redis Caching.</p><h1 id=what-is-in-memory-caching-with-imemorycache>What is In-Memory Caching with IMemoryCache?</h1><p>In-Memory Caching is a technique where frequently accessed data is stored in memory, reducing the need to fetch it from the data source repeatedly. In .NET Core, the IMemoryCache interface provides a convenient way to implement this caching mechanism.</p><h1 id=rationale-for-using-in-memory-caching-with-imemorycache>Rationale for Using In-Memory Caching with IMemoryCache</h1><h2 id=performance-improvement>Performance Improvement</h2><p>IMemoryCache stores data in the application&rsquo;s memory, providing fast access for subsequent requests. This reduces the need to perform expensive operations, such as database queries or external API calls, repeatedly.</p><h2 id=scalability>Scalability</h2><p>In a microservices or modular monolithic architecture, In-Memory Caching can enhance scalability by reducing the load on data sources. This is especially beneficial when dealing with a large number of concurrent requests.</p><h2 id=reduction-of-resource-usage>Reduction of Resource Usage</h2><p>By storing frequently accessed data in memory, In-Memory Caching can help optimize resource usage and improve overall system efficiency.</p><h1 id=implementing-in-memory-caching-in-an-e-commerce-system>Implementing In-Memory Caching in an E-commerce System</h1><p>Let&rsquo;s consider an example of implementing In-Memory Caching in the context of an e-commerce system built with .NET Core.</p><h4 id=setting-up-in-memory-caching-in-net-core>Setting up In-Memory Caching in .NET Core:</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>// Startup.cs</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> ConfigureServices(IServiceCollection services)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Other configurations...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    services.AddMemoryCache();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Other configurations...</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Here, we configure the application to use the in-memory cache by adding <code>services.AddMemoryCache()</code> to the service collection.</p><h4 id=using-in-memory-caching-in-e-commerce-services>Using In-Memory Caching in E-commerce Services:</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ProductService.cs</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>async</span> Task&lt;List&lt;Product&gt;&gt; GetAllProductsAsync()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> cacheKey = <span style=color:#e6db74>&#34;AllProducts&#34;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> cachedProducts = <span style=color:#66d9ef>await</span> _cache.GetOrCreateAsync(cacheKey, entry =&gt;
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Set cache expiration or other policies if needed</span>
</span></span><span style=display:flex><span>        entry.SlidingExpiration = TimeSpan.FromMinutes(<span style=color:#ae81ff>30</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> _repository.GetAllProductsAsync();
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> cachedProducts;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>In this example, the <code>ProductService</code> checks the in-memory cache for a list of products. If the data is not present, it fetches it from the repository, stores it in the cache, and returns the result.</p><h1 id=advantages-and-disadvantages-of-in-memory-caching-with-imemorycache>Advantages and Disadvantages of In-Memory Caching with IMemoryCache</h1><h2 id=advantages>Advantages</h2><ul><li><strong>Simplicity</strong>: Easy to set up and use without external dependencies.</li><li><strong>Fast Access</strong>: Provides fast access to cached data directly from the application&rsquo;s memory.</li><li><strong>Integrated with .NET Core</strong>: Seamlessly integrates with the .NET Core framework.</li></ul><h2 id=disadvantages>Disadvantages</h2><ul><li><strong>Limited to a Single Instance</strong>: In-memory caching is local to the application instance and doesn&rsquo;t support distributed scenarios out of the box.</li><li><strong>Finite Memory</strong>: Limited by the available memory, which can be a constraint for large datasets.</li></ul><h1 id=when-to-use-in-memory-caching-with-imemorycache>When to Use In-Memory Caching with IMemoryCache</h1><p>Use Cases/Scenarios:</p><ul><li>Frequent Read Operations: Ideal for scenarios where read operations outnumber writes.</li><li>Small to Medium-sized Datasets: Suitable for caching smaller datasets that fit comfortably in memory.</li></ul><h1 id=best-practices>Best Practices</h1><p><strong>Cache Expiration</strong></p><ul><li>Set appropriate cache expiration policies using features like <code>SlidingExpiration</code> or <code>AbsoluteExpiration</code>.</li></ul><p><strong>Cache Invalidation</strong></p><ul><li>Implement a robust cache invalidation strategy to ensure data consistency.</li></ul><p><strong>Monitoring</strong></p><ul><li>Monitor memory usage to prevent potential performance issues.</li><li>Consider using logging to track cache hits and misses for analysis.</li></ul><h1 id=comparing-in-memory-caching-with-redis-caching>Comparing In-Memory Caching with Redis Caching</h1><p><strong>Advantages over Redis Caching</strong></p><ul><li><strong>Simplicity</strong>: In-Memory Caching is easier to set up and doesn&rsquo;t require an external Redis server.</li><li><strong>Integrated with .NET Core</strong>: Being part of the .NET Core framework, IMemoryCache is a native solution.</li></ul><h1 id=conclusion>Conclusion</h1><p>In-Memory Caching with IMemoryCache is a powerful and straightforward solution for improving performance in .NET Core applications. While it has its limitations, it provides a lightweight and easy-to-use caching mechanism, especially in scenarios where distributed caching is not a primary requirement.</p><h1 id=references>References:</h1><ul><li><a href=https://docs.microsoft.com/en-us/aspnet/core/performance/caching/memory target=_blank>.NET Core Documentation - In-Memory Caching</a></li><li><a href=https://www.nuget.org/packages/Microsoft.Extensions.Caching.Memory/ target=_blank>Microsoft.Extensions.Caching.Memory NuGet Package</a></li></ul><hr><div class=footer><p>This is a post in the <b><a href=https://gosang.github.io/series/caching>Caching</a></b> series.<br>Other posts in this series:<ul class=series><li>July 17, 2022 -
<a href=/posts/design-patterns/caching/implementing-redis-cache-in-dotnet-core/>Implementing Redis as a Cache Service in .NET Core</a></li><li>June 14, 2022 -
Implementing In-Memory Caching in .NET Core with IMemoryCache</li><li>May 16, 2022 -
<a href=/posts/design-patterns/caching/difference-between-imemorycache-and-redis/>Difference Between Imemorycache and Redis</a></li><li>April 12, 2022 -
<a href=/posts/design-patterns/caching/caching-pattern/>Caching Pattern</a></li></ul></p></div></div></main><div class=article-toc><div class=toc-wrapper><h4 id=contents></h4><nav id=TableOfContents><ul><li><a href=#performance-improvement>Performance Improvement</a></li><li><a href=#scalability>Scalability</a></li><li><a href=#reduction-of-resource-usage>Reduction of Resource Usage</a></li></ul><ul><li><ul><li></li></ul></li></ul><ul><li><a href=#advantages>Advantages</a></li><li><a href=#disadvantages>Disadvantages</a></li></ul></nav></div></div></div></body></html>