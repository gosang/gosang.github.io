<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en-us lang=en-us><head><script defer language=javascript type=text/javascript src=/js/bundle.min.11d62625e7495f8147fccf5d08f37bded574a50c4508c235cc666848567d99ab.js></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=/favicon.png><title itemprop=name>Go Sang - Implementing Amazon SQS with ASP.NET Core 8 API</title><meta property="og:title" content="Go Sang - Implementing Amazon SQS with ASP.NET Core 8 API"><meta name=twitter:title content="Go Sang - Implementing Amazon SQS with ASP.NET Core 8 API"><meta itemprop=name content="Go Sang - Implementing Amazon SQS with ASP.NET Core 8 API"><meta name=application-name content="Go Sang - Implementing Amazon SQS with ASP.NET Core 8 API"><meta property="og:site_name" content><meta name=description content><meta itemprop=description content><meta property="og:description" content><meta name=twitter:description content><base href=https://gosang.github.io/posts/dotnet/implementing-amazon-sqs-with-asp-dotnet-core/><link rel=canonical href=https://gosang.github.io/posts/dotnet/implementing-amazon-sqs-with-asp-dotnet-core/ itemprop=url><meta name=url content="https://gosang.github.io/posts/dotnet/implementing-amazon-sqs-with-asp-dotnet-core/"><meta name=twitter:url content="https://gosang.github.io/posts/dotnet/implementing-amazon-sqs-with-asp-dotnet-core/"><meta property="og:url" content="https://gosang.github.io/posts/dotnet/implementing-amazon-sqs-with-asp-dotnet-core/"><meta property="og:updated_time" content="25008-25-12T813:31:24+0100"><link rel=sitemap type=application/xml title=Sitemap href=https://gosang.github.io/sitemap.xml><meta name=robots content="index,follow"><meta name=googlebot content="index,follow"><meta name=twitter:site content><meta name=twitter:creator content><meta property="fb:admins" content><meta name=apple-mobile-web-app-title content><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black"><meta property="og:type" content="article"><meta property="article:publisher" content><meta property="og:article:published_time" content="25008-25-12T813:31:24+0100"><meta property="article:published_time" content="25008-25-12T813:31:24+0100"><script defer type=application/ld+json>{"@context":"http://schema.org","@type":"Article","headline":"Implementing Amazon SQS with ASP.NET Core 8 API","author":{"@type":"Person","name":"https:\/\/github.com\/gosang"},"datePublished":"2024-08-25","description":"","wordCount":"1086","mainEntityOfPage":"True","dateModified":"2024-08-25","image":{"@type":"imageObject","url":""},"publisher":{"@type":"Organization","name":"","logo":{"@type":"imageObject","url":""}}}</script><meta name=generator content="Hugo 0.119.0"><link type=text/css rel=stylesheet href=/css/bundle.min.178e339ccb9acabffeebf9adbb0bb23c1ec0b72a2a50edee18a5007d4d5a68aa.css><style>body{--sidebar-bg-color:#202020;--sidebar-img-border-color:#515151;--sidebar-p-color:#909090;--sidebar-h1-color:#FFF;--sidebar-a-color:#FFF;--sidebar-socials-color:#FFF;--text-color:#222;--bkg-color:#FAF9F6;--post-title-color:#303030;--list-color:#5a5a5a;--link-color:#268bd2;--date-color:#515151;--table-border-color:#E5E5E5;--table-stripe-color:#F9F9F9;--code-color:#bf616a;--code-background-color:#E5E5E5;--moon-sun-color:#FFF;--moon-sun-background-color:#515151}body.dark-theme{--text-color:#eee;--bkg-color:#121212;--post-title-color:#DBE2E9;--list-color:#9d9d9d;--link-color:#268bd2;--date-color:#9a9a9a;--table-border-color:#515151;--table-stripe-color:#202020;--code-color:#ff7f7f;--code-background-color:#393D47}body{background-color:var(--bkg-color)}</style></head><body><div class=wrapper><aside class=sidebar><div class="container sidebar-sticky"><div class=light-dark align=right><button class=btn-light-dark title="Toggle light/dark mode"><svg class="moon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16"><path fill="currentcolor" d="M6 .278a.768.768.0 01.08.858 7.208 7.208.0 00-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527.0 1.04-.055 1.533-.16a.787.787.0 01.81.316.733.733.0 01-.031.893A8.349 8.349.0 018.344 16C3.734 16 0 12.286.0 7.71.0 4.266 2.114 1.312 5.124.06A.752.752.0 016 .278z"/></svg><svg class="sun" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16"><path fill="currentcolor" d="M8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0zm0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13zm8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5zM3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8zm10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0zm-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0zm9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707zM4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708z"/></svg></button></div><div class=sidebar-about><h1 class=brand><a href=https://gosang.github.io/><h1>Go Sang</h1></a></h1><p class=lead>Learning about technology.</p></div><nav><ul class=sidebar-nav><li class=heading><a href=/posts/>Posts</a></li><li class=sub-heading>Recent</li><li class=bullet><a href=https://gosang.github.io/posts/caching/implementing-distributed-caching-in-asp-dotnet-core-with-redis/>Implementing Distributed Caching in ASP.NET Core with Redis</a></li><li class=bullet><a href=https://gosang.github.io/posts/ai/retrieval-augmented-generation-architecture-patterns/>Retrieval Augmented Generation Architecture Patterns</a></li><li class=bullet><a href=https://gosang.github.io/posts/dotnet/implementing-range-based-pagination-with-mongodb-csharp-driver-in-asp-dotnet-core/>Implementing Range-Based Pagination with MongoDB C# Driver in ASP.NET Core 8</a></li><li class=bullet><a href=https://gosang.github.io/posts/dotnet/implementing-pagination-with-mongodb-csharp-driver-in-asp-dotnet-core/>Implementing Pagination with MongoDB C# Driver in ASP.NET Core 8</a></li><li class=bullet><a href=https://gosang.github.io/posts/react/zustand-redux-context-choosing-the-right-state-management-solution/>Zustand, Redux and Context: Choosing the Right State Management Solution</a></li></ul></nav><a target=_blank class=social title=GitHub href=https://github.com/gosang><svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="-2 -2 24 24"><path fill="currentcolor" d="M18.88 1.099C18.147.366 17.265.0 16.233.0H3.746C2.714.0 1.832.366 1.099 1.099.366 1.832.0 2.714.0 3.746v12.487c0 1.032.366 1.914 1.099 2.647.733.733 1.615 1.099 2.647 1.099H6.66c.19.0.333-.007.429-.02a.504.504.0 00.286-.169c.095-.1.143-.245.143-.435l-.007-.885c-.004-.564-.006-1.01-.006-1.34l-.3.052c-.19.035-.43.05-.721.046a5.555 5.555.0 01-.904-.091 2.026 2.026.0 01-.872-.39 1.651 1.651.0 01-.572-.8l-.13-.3a3.25 3.25.0 00-.41-.663c-.186-.243-.375-.407-.566-.494l-.09-.065a.956.956.0 01-.17-.156.723.723.0 01-.117-.182c-.026-.061-.004-.111.065-.15.07-.04.195-.059.378-.059l.26.04c.173.034.388.138.643.311a2.1 2.1.0 01.631.677c.2.355.44.626.722.813.282.186.566.28.852.28.286.0.533-.022.742-.065a2.59 2.59.0 00.585-.196c.078-.58.29-1.028.637-1.34a8.907 8.907.0 01-1.333-.234 5.314 5.314.0 01-1.223-.507 3.5 3.5.0 01-1.047-.872c-.277-.347-.505-.802-.683-1.365-.177-.564-.266-1.215-.266-1.952.0-1.049.342-1.942 1.027-2.68-.32-.788-.29-1.673.091-2.652.252-.079.625-.02 1.119.175.494.195.856.362 1.086.5.23.14.414.257.553.352a9.233 9.233.0 012.497-.338c.859.0 1.691.113 2.498.338l.494-.312a6.997 6.997.0 011.197-.572c.46-.174.81-.221 1.054-.143.39.98.424 1.864.103 2.653.685.737 1.028 1.63 1.028 2.68.0.737-.089 1.39-.267 1.957-.177.568-.407 1.023-.689 1.366a3.65 3.65.0 01-1.053.865c-.42.234-.828.403-1.223.507a8.9 8.9.0 01-1.333.235c.45.39.676 1.005.676 1.846v3.11c0 .147.021.266.065.357a.36.36.0 00.208.189c.096.034.18.056.254.064.074.01.18.013.318.013h2.914c1.032.0 1.914-.366 2.647-1.099.732-.732 1.099-1.615 1.099-2.647V3.746c0-1.032-.367-1.914-1.1-2.647z"/></svg></a><a target=_blank class=social title="RSS Feed" href=https://gosang.github.io//posts/index.xml><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 1280 1280"><g transform="translate(0.000000,1280.000000) scale(0.100000,-0.100000)" fill="currentcolor"><path d="M2295 11929c-284-12-642-45-707-65-17-5-18-63-18-1039 0-569 4-1036 8-1039 5-3 74 6 153 19 510 86 1168 95 1789 25 1348-153 2602-677 3670-1531 385-308 820-744 1126-1129 842-1060 1362-2313 1514-3650 70-621 61-1279-25-1789-13-79-22-148-19-153 3-4 471-8 1039-8h1035l5 23c51 225 85 942 67 1419-23 605-77 1044-198 1617-294 14e2-927 2734-1823 3846-1043 1295-2364 2259-3909 2854-1158 447-2451 656-3707 6e2z"/><path d="M2255 7845c-269-25-620-81-667-106-17-9-18-55-18-899 0-706 3-890 13-890 6 0 66 18 132 41 130 44 288 79 467 105 154 21 577 30 749 15 1207-107 2267-823 2814-1902 166-327 268-637 330-1001 38-227 48-384 42-662-8-348-44-590-126-831-23-66-41-126-41-132 0-10 184-13 890-13 844 0 890 1 899 18 27 50 88 452 110 725 14 162 14 624 1 782-59 703-233 1323-545 1945-481 956-1313 1788-2270 2268-620 310-1239 483-1940 542-165 14-669 10-840-5z"/><path d="M2519 3815c-391-66-725-336-868-703-79-201-96-462-45-677 83-344 338-641 666-774 116-47 205-69 330-80 412-39 811 153 1040 5e2 193 292 240 648 128 981-135 403-492 699-914 757-1e2 14-241 12-337-4z"/></g></svg></a><p class=footnote>powered by <a target=_blank href=https://gohugo.io>Hugo</a> | themed with <a target=_blank href=https://github.com/lukeorth/poison>poison</a><br>&copy; 2025 . All rights reserved.</p></div></aside><main class="content container"><div class=post><div class=info><h1 class=post-title><a href=https://gosang.github.io/posts/dotnet/implementing-amazon-sqs-with-asp-dotnet-core/>Implementing Amazon SQS with ASP.NET Core 8 API</a></h1><time datetime=2024-08-25T12:13:31+0100 class=post-date>August 25, 2024</time><ul class=tags><li class="tag-ASP.NET Core"><a href=https://gosang.github.io/tags/asp.net-core>ASP.NET Core</a></li><li class=tag-AWS><a href=https://gosang.github.io/tags/aws>AWS</a></li><li class=tag-SES><a href=https://gosang.github.io/tags/ses>SES</a></li><li class=tag-Email><a href=https://gosang.github.io/tags/email>Email</a></li></ul></div><p>Amazon Simple Queue Service (SQS) is a fully managed message queuing service provided by AWS. It enables the decoupling of microservices, distributed systems, and serverless applications by allowing them to communicate asynchronously. This blog post will walk you through the concepts, rationale, and practical implementation of Amazon SQS using ASP.NET Core 8 API. We&rsquo;ll also discuss the advantages, disadvantages, best practices, and scenarios where SQS is suitable or not.</p><h1 id=what-is-amazon-sqs>What is Amazon SQS?</h1><h2 id=overview>Overview</h2><p>Amazon SQS is a message queuing service that allows you to send, store, and receive messages between software components, making it easier to build scalable and decoupled systems. SQS supports two types of queues:</p><ul><li><strong>Standard Queue</strong>: Provides maximum throughput, best-effort ordering, and at-least-once delivery. However, messages might be delivered out of order or more than once.</li><li><strong>FIFO (First-In-First-Out) Queue</strong>: Ensures messages are processed exactly once, in the order they were sent. This type of queue is ideal when the order of operations is critical.</li></ul><h2 id=key-concepts>Key Concepts</h2><ul><li><strong>Queue</strong>: A temporary storage location for messages. You send messages to the queue and receive them from it.</li><li><strong>Message</strong>: The data sent between different components via SQS.</li><li><strong>Producer</strong>: The component that sends messages to the queue.</li><li><strong>Consumer</strong>: The component that retrieves and processes messages from the queue.</li><li><strong>Visibility Timeout</strong>: The time during which a message is invisible to other consumers after being retrieved from the queue.</li><li><strong>Dead-Letter Queue (DLQ)</strong>: A secondary queue used to store messages that could not be processed successfully after multiple attempts.</li></ul><h2 id=why-use-amazon-sqs>Why Use Amazon SQS?</h2><p>Amazon SQS is an excellent choice for applications that require:</p><ul><li><strong>Decoupling</strong>: Separate the components of a distributed system to reduce dependencies and increase reliability.</li><li><strong>Scalability</strong>: Handle varying workloads without the need for manual intervention.</li><li><strong>Fault Tolerance</strong>: Queue messages for later processing if downstream components are temporarily unavailable.</li></ul><h1 id=implementing-amazon-sqs-with-aspnet-core-8-api>Implementing Amazon SQS with ASP.NET Core 8 API</h1><h2 id=prerequisites>Prerequisites</h2><p>Before diving into the implementation, ensure you have the following:</p><ul><li>An AWS account with IAM permissions to use SQS.</li><li>.NET SDK 8 installed.</li><li>An ASP.NET Core 8 project created.</li></ul><h2 id=step-1-install-aws-sdk-for-net>Step 1: Install AWS SDK for .NET</h2><p>First, install the AWS SDK for .NET, which includes the Amazon SQS package.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>dotnet add package AWSSDK.SQS
</span></span></code></pre></div><h2 id=step-2-configure-aws-sqs-in-aspnet-core>Step 2: Configure AWS SQS in ASP.NET Core</h2><p>Next, configure the AWS SQS client in your ASP.NET Core 8 application. You can do this in the <code>Program.cs</code> file.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#66d9ef>using</span> Amazon.SQS;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> Amazon.Extensions.NETCore.Setup;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> builder = WebApplication.CreateBuilder(args);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Add AWS services to the container.</span>
</span></span><span style=display:flex><span>builder.Services.AddDefaultAWSOptions(builder.Configuration.GetAWSOptions());
</span></span><span style=display:flex><span>builder.Services.AddAWSService&lt;IAmazonSQS&gt;();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> app = builder.Build();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>app.MapGet(<span style=color:#e6db74>&#34;/&#34;</span>, () =&gt; <span style=color:#e6db74>&#34;Hello, World!&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>app.Run();
</span></span></code></pre></div><p>Ensure that your <code>appsettings.json</code> includes the necessary AWS credentials:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;AWS&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;Region&#34;</span>: <span style=color:#e6db74>&#34;us-east-1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;Profile&#34;</span>: <span style=color:#e6db74>&#34;default&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=step-3-send-a-message-to-sqs>Step 3: Send a Message to SQS</h2><p>Create a service to handle sending messages to the SQS queue.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SqsService</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> IAmazonSQS _sqsClient;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#66d9ef>string</span> _queueUrl;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> SqsService(IAmazonSQS sqsClient, IConfiguration configuration)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        _sqsClient = sqsClient;
</span></span><span style=display:flex><span>        _queueUrl = configuration[<span style=color:#e6db74>&#34;AWS:QueueUrl&#34;</span>];
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>async</span> Task SendMessageAsync(<span style=color:#66d9ef>string</span> message)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> sendMessageRequest = <span style=color:#66d9ef>new</span> SendMessageRequest
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            QueueUrl = _queueUrl,
</span></span><span style=display:flex><span>            MessageBody = message
</span></span><span style=display:flex><span>        };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> response = <span style=color:#66d9ef>await</span> _sqsClient.SendMessageAsync(sendMessageRequest);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (response.HttpStatusCode != HttpStatusCode.OK)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> Exception(<span style=color:#e6db74>&#34;Failed to send message to SQS&#34;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=step-4-receive-and-process-messages-from-sqs>Step 4: Receive and Process Messages from SQS</h2><p>Now, create a method to receive and process messages from the queue.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>async</span> Task ReceiveMessagesAsync()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> receiveMessageRequest = <span style=color:#66d9ef>new</span> ReceiveMessageRequest
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        QueueUrl = _queueUrl,
</span></span><span style=display:flex><span>        MaxNumberOfMessages = <span style=color:#ae81ff>10</span>,
</span></span><span style=display:flex><span>        WaitTimeSeconds = <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> response = <span style=color:#66d9ef>await</span> _sqsClient.ReceiveMessageAsync(receiveMessageRequest);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>foreach</span> (<span style=color:#66d9ef>var</span> message <span style=color:#66d9ef>in</span> response.Messages)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// Process the message</span>
</span></span><span style=display:flex><span>            Console.WriteLine(<span style=color:#e6db74>$&#34;Processing message: {message.Body}&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>// Delete the message after processing</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> deleteMessageRequest = <span style=color:#66d9ef>new</span> DeleteMessageRequest
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                QueueUrl = _queueUrl,
</span></span><span style=display:flex><span>                ReceiptHandle = message.ReceiptHandle
</span></span><span style=display:flex><span>            };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>await</span> _sqsClient.DeleteMessageAsync(deleteMessageRequest);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>catch</span> (Exception ex)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            Console.WriteLine(<span style=color:#e6db74>$&#34;Error processing message: {ex.Message}&#34;</span>);
</span></span><span style=display:flex><span>            <span style=color:#75715e>// Handle the exception (e.g., send to DLQ)</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=step-5-integrate-sqs-service-in-your-api>Step 5: Integrate SQS Service in Your API</h2><p>Finally, integrate the SQS service into your API controller.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#a6e22e>[ApiController]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>[Route(&#34;api/[controller]</span><span style=color:#e6db74>&#34;)]
</span></span></span><span style=display:flex><span><span style=color:#e6db74></span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MessagesController</span> : ControllerBase
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> SqsService _sqsService;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> MessagesController(SqsService sqsService)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        _sqsService = sqsService;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span><span style=color:#a6e22e>
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>    [HttpPost]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>async</span> Task&lt;IActionResult&gt; SendMessage([FromBody] <span style=color:#66d9ef>string</span> message)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>await</span> _sqsService.SendMessageAsync(message);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> Ok(<span style=color:#e6db74>&#34;Message sent to SQS.&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span><span style=color:#a6e22e>
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>    [HttpGet]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>async</span> Task&lt;IActionResult&gt; ReceiveMessages()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>await</span> _sqsService.ReceiveMessagesAsync();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> Ok(<span style=color:#e6db74>&#34;Messages received and processed.&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=advantages-of-implementing-amazon-sqs-with-aspnet-core-8-api>Advantages of Implementing Amazon SQS with ASP.NET Core 8 API</h1><table><thead><tr><th>Advantage</th><th>Disadvantage</th></tr></thead><tbody><tr><td><strong>Scalability</strong>: SQS automatically scales to handle large volumes of messages.</td><td><strong>Latency</strong>: SQS introduces some latency due to the decoupling nature of message queuing.</td></tr><tr><td><strong>Reliability</strong>: Messages are stored redundantly across multiple availability zones, ensuring high availability.</td><td><strong>Complexity</strong>: Managing message queues, especially when dealing with dead-letter queues and visibility timeouts, can add complexity to your system.</td></tr><tr><td><strong>Decoupling</strong>: SQS allows you to decouple your services, making the system more resilient to failures.</td><td><strong>Limited Message Size</strong>: SQS messages are limited to 256 KB, which might require additional handling for larger payloads.</td></tr><tr><td><strong>Cost-Effective</strong>: You pay only for the usage, making it cost-effective for many applications.</td><td></td></tr></tbody></table><h1 id=when-to-use-amazon-sqs-with-aspnet-core-8-api>When to Use Amazon SQS with ASP.NET Core 8 API</h1><table><thead><tr><th>When to use</th><th>When not to use</th></tr></thead><tbody><tr><td><strong>Asynchronous Processing</strong>: When tasks can be processed asynchronously, such as sending emails or processing background jobs.</td><td><strong>Real-Time Processing</strong>: When low latency is critical, such as in real-time gaming or trading applications.</td></tr><tr><td><strong>Decoupling Services</strong>: When you want to reduce dependencies between different services or components in your system.</td><td><strong>Small Applications</strong>: For simple applications, the overhead of managing SQS might outweigh its benefits.</td></tr><tr><td><strong>Rate Limiting</strong>: When you need to throttle the number of requests processed by a service.</td><td><strong>Stateful Applications</strong>: When the state needs to be maintained across services, direct communication might be more appropriate.</td></tr></tbody></table><h1 id=issues-considerations-and-best-practices>Issues, Considerations, and Best Practices</h1><h2 id=issues>Issues</h2><ul><li><strong>Message Duplication</strong>: SQS might deliver a message more than once, requiring idempotent message processing.</li><li><strong>Visibility Timeout</strong>: Incorrect configuration can lead to message loss or multiple processes handling the same message.</li><li><strong>Error Handling</strong>: Messages that fail to process should be routed to a dead-letter queue to avoid blocking the processing pipeline.</li></ul><h2 id=best-practices>Best Practices</h2><ul><li><strong>Use Dead-Letter Queues</strong>: Set up DLQs to handle messages that fail to process after multiple attempts.</li><li><strong>Implement Idempotency</strong>: Ensure that your message processing logic is idempotent to handle message duplication gracefully.</li><li><strong>Monitor and Alert</strong>: Use AWS CloudWatch to monitor your queues and set up alerts for unusual activity, such as an increase in message age or DLQ traffic.</li></ul><h1 id=conclusion>Conclusion</h1><p>Amazon SQS is a powerful tool for building scalable, decoupled applications, and integrating it with ASP.NET Core 8 is relatively straightforward. However, it&rsquo;s essential to understand its strengths and limitations to use it effectively. By following best practices and carefully considering your application&rsquo;s requirements, you can leverage SQS to build robust and reliable systems.</p><h1 id=references>References</h1><ul><li><p><a href=https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/welcome.html target=_blank>AWS SQS Documentation</a></p></li><li><p><a href=https://aws.amazon.com/developer/language/net/ target=_blank>AWS SDK for .NET documentation</a></p></li></ul><hr><div class=footer><a class=previous-post href="https://gosang.github.io/posts/dotnet/sending-emails-in-asp-dotnet-core-with-aws-simple-email-service/?ref=footer"><span style=font-weight:700>« Previous</span><br>Sending Emails in ASP.NET Core With AWS Simple...</a><div class=next-post><a href="https://gosang.github.io/posts/dotnet/simplifying-object-oriented-programming-in-asp-dotnet-core/?ref=footer"><span style=font-weight:700>Next »</span><br>Simplifying Object-Oriented Programming in ASP.NET...</a></div></div></div></main><div class=article-toc><div class=toc-wrapper><h4 id=contents></h4><nav id=TableOfContents><ul><li><a href=#overview>Overview</a></li><li><a href=#key-concepts>Key Concepts</a></li><li><a href=#why-use-amazon-sqs>Why Use Amazon SQS?</a></li></ul><ul><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#step-1-install-aws-sdk-for-net>Step 1: Install AWS SDK for .NET</a></li><li><a href=#step-2-configure-aws-sqs-in-aspnet-core>Step 2: Configure AWS SQS in ASP.NET Core</a></li><li><a href=#step-3-send-a-message-to-sqs>Step 3: Send a Message to SQS</a></li><li><a href=#step-4-receive-and-process-messages-from-sqs>Step 4: Receive and Process Messages from SQS</a></li><li><a href=#step-5-integrate-sqs-service-in-your-api>Step 5: Integrate SQS Service in Your API</a></li></ul><ul><li><a href=#issues>Issues</a></li><li><a href=#best-practices>Best Practices</a></li></ul></nav></div></div></div></body></html>