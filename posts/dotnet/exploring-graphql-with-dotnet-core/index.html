<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en-us lang=en-us><head><script defer language=javascript type=text/javascript src=/js/bundle.min.11d62625e7495f8147fccf5d08f37bded574a50c4508c235cc666848567d99ab.js></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=/favicon.png><title itemprop=name>Go Sang - Exploring GraphQL With .NET Core</title><meta property="og:title" content="Go Sang - Exploring GraphQL With .NET Core"><meta name=twitter:title content="Go Sang - Exploring GraphQL With .NET Core"><meta itemprop=name content="Go Sang - Exploring GraphQL With .NET Core"><meta name=application-name content="Go Sang - Exploring GraphQL With .NET Core"><meta property="og:site_name" content><meta name=description content><meta itemprop=description content><meta property="og:description" content><meta name=twitter:description content><base href=https://gosang.github.io/posts/dotnet/exploring-graphql-with-dotnet-core/><link rel=canonical href=https://gosang.github.io/posts/dotnet/exploring-graphql-with-dotnet-core/ itemprop=url><meta name=url content="https://gosang.github.io/posts/dotnet/exploring-graphql-with-dotnet-core/"><meta name=twitter:url content="https://gosang.github.io/posts/dotnet/exploring-graphql-with-dotnet-core/"><meta property="og:url" content="https://gosang.github.io/posts/dotnet/exploring-graphql-with-dotnet-core/"><meta property="og:updated_time" content="27005-27-06T51:02:21Z"><link rel=sitemap type=application/xml title=Sitemap href=https://gosang.github.io/sitemap.xml><meta name=robots content="index,follow"><meta name=googlebot content="index,follow"><meta name=twitter:site content><meta name=twitter:creator content><meta property="fb:admins" content><meta name=apple-mobile-web-app-title content><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black"><meta property="og:type" content="article"><meta property="article:publisher" content><meta property="og:article:published_time" content="27005-27-06T51:02:21Z"><meta property="article:published_time" content="27005-27-06T51:02:21Z"><script defer type=application/ld+json>{"@context":"http://schema.org","@type":"Article","headline":"Exploring GraphQL With .NET Core","author":{"@type":"Person","name":"https:\/\/github.com\/gosang"},"datePublished":"2021-05-27","description":"","wordCount":"1185","mainEntityOfPage":"True","dateModified":"2021-05-27","image":{"@type":"imageObject","url":""},"publisher":{"@type":"Organization","name":"","logo":{"@type":"imageObject","url":""}}}</script><meta name=generator content="Hugo 0.119.0"><link type=text/css rel=stylesheet href=/css/bundle.min.178e339ccb9acabffeebf9adbb0bb23c1ec0b72a2a50edee18a5007d4d5a68aa.css><style>body{--sidebar-bg-color:#202020;--sidebar-img-border-color:#515151;--sidebar-p-color:#909090;--sidebar-h1-color:#FFF;--sidebar-a-color:#FFF;--sidebar-socials-color:#FFF;--text-color:#222;--bkg-color:#FAF9F6;--post-title-color:#303030;--list-color:#5a5a5a;--link-color:#268bd2;--date-color:#515151;--table-border-color:#E5E5E5;--table-stripe-color:#F9F9F9;--code-color:#bf616a;--code-background-color:#E5E5E5;--moon-sun-color:#FFF;--moon-sun-background-color:#515151}body.dark-theme{--text-color:#eee;--bkg-color:#121212;--post-title-color:#DBE2E9;--list-color:#9d9d9d;--link-color:#268bd2;--date-color:#9a9a9a;--table-border-color:#515151;--table-stripe-color:#202020;--code-color:#ff7f7f;--code-background-color:#393D47}body{background-color:var(--bkg-color)}</style></head><body><div class=wrapper><aside class=sidebar><div class="container sidebar-sticky"><div class=light-dark align=right><button class=btn-light-dark title="Toggle light/dark mode"><svg class="moon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16"><path fill="currentcolor" d="M6 .278a.768.768.0 01.08.858 7.208 7.208.0 00-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527.0 1.04-.055 1.533-.16a.787.787.0 01.81.316.733.733.0 01-.031.893A8.349 8.349.0 018.344 16C3.734 16 0 12.286.0 7.71.0 4.266 2.114 1.312 5.124.06A.752.752.0 016 .278z"/></svg><svg class="sun" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16"><path fill="currentcolor" d="M8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0zm0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13zm8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5zM3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8zm10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0zm-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0zm9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707zM4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708z"/></svg></button></div><div class=sidebar-about><h1 class=brand><a href=https://gosang.github.io/><h1>Go Sang</h1></a></h1><p class=lead>Learning about technology.</p></div><nav><ul class=sidebar-nav><li class=heading><a href=/posts/>Posts</a></li><li class=sub-heading>Recent</li><li class=bullet><a href=https://gosang.github.io/posts/dotnet/api-versioning-in-asp-dotnet-core/>API Versioning in ASP.NET Core</a></li><li class=bullet><a href=https://gosang.github.io/posts/react/advanced-server-rendering-react-query-with-nextjs-app-router/>Advanced Server Rendering: React Query With Next.js App Router</a></li><li class=bullet><a href=https://gosang.github.io/posts/dotnet/dotnet-aspire-simplifying-dotnet-cloud-native-development/>.NET Aspire: Simplifying .NET Cloud-Native Development</a></li><li class=bullet><a href=https://gosang.github.io/posts/dotnet/software-architecture-testing-in-dotnet-using-archunit/>Software Architecture Testing in .NET Core Using ArchUnit</a></li><li class=bullet><a href=https://gosang.github.io/posts/dotnet/rate-limiting-in-dot-core/>Rate Limiting in ASP.NET Core 8 Web API</a></li></ul></nav><a target=_blank class=social title=GitHub href=https://github.com/gosang><svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="-2 -2 24 24"><path fill="currentcolor" d="M18.88 1.099C18.147.366 17.265.0 16.233.0H3.746C2.714.0 1.832.366 1.099 1.099.366 1.832.0 2.714.0 3.746v12.487c0 1.032.366 1.914 1.099 2.647.733.733 1.615 1.099 2.647 1.099H6.66c.19.0.333-.007.429-.02a.504.504.0 00.286-.169c.095-.1.143-.245.143-.435l-.007-.885c-.004-.564-.006-1.01-.006-1.34l-.3.052c-.19.035-.43.05-.721.046a5.555 5.555.0 01-.904-.091 2.026 2.026.0 01-.872-.39 1.651 1.651.0 01-.572-.8l-.13-.3a3.25 3.25.0 00-.41-.663c-.186-.243-.375-.407-.566-.494l-.09-.065a.956.956.0 01-.17-.156.723.723.0 01-.117-.182c-.026-.061-.004-.111.065-.15.07-.04.195-.059.378-.059l.26.04c.173.034.388.138.643.311a2.1 2.1.0 01.631.677c.2.355.44.626.722.813.282.186.566.28.852.28.286.0.533-.022.742-.065a2.59 2.59.0 00.585-.196c.078-.58.29-1.028.637-1.34a8.907 8.907.0 01-1.333-.234 5.314 5.314.0 01-1.223-.507 3.5 3.5.0 01-1.047-.872c-.277-.347-.505-.802-.683-1.365-.177-.564-.266-1.215-.266-1.952.0-1.049.342-1.942 1.027-2.68-.32-.788-.29-1.673.091-2.652.252-.079.625-.02 1.119.175.494.195.856.362 1.086.5.23.14.414.257.553.352a9.233 9.233.0 012.497-.338c.859.0 1.691.113 2.498.338l.494-.312a6.997 6.997.0 011.197-.572c.46-.174.81-.221 1.054-.143.39.98.424 1.864.103 2.653.685.737 1.028 1.63 1.028 2.68.0.737-.089 1.39-.267 1.957-.177.568-.407 1.023-.689 1.366a3.65 3.65.0 01-1.053.865c-.42.234-.828.403-1.223.507a8.9 8.9.0 01-1.333.235c.45.39.676 1.005.676 1.846v3.11c0 .147.021.266.065.357a.36.36.0 00.208.189c.096.034.18.056.254.064.074.01.18.013.318.013h2.914c1.032.0 1.914-.366 2.647-1.099.732-.732 1.099-1.615 1.099-2.647V3.746c0-1.032-.367-1.914-1.1-2.647z"/></svg></a><a target=_blank class=social title="RSS Feed" href=https://gosang.github.io//posts/index.xml><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 1280 1280"><g transform="translate(0.000000,1280.000000) scale(0.100000,-0.100000)" fill="currentcolor"><path d="M2295 11929c-284-12-642-45-707-65-17-5-18-63-18-1039 0-569 4-1036 8-1039 5-3 74 6 153 19 510 86 1168 95 1789 25 1348-153 2602-677 3670-1531 385-308 820-744 1126-1129 842-1060 1362-2313 1514-3650 70-621 61-1279-25-1789-13-79-22-148-19-153 3-4 471-8 1039-8h1035l5 23c51 225 85 942 67 1419-23 605-77 1044-198 1617-294 14e2-927 2734-1823 3846-1043 1295-2364 2259-3909 2854-1158 447-2451 656-3707 6e2z"/><path d="M2255 7845c-269-25-620-81-667-106-17-9-18-55-18-899 0-706 3-890 13-890 6 0 66 18 132 41 130 44 288 79 467 105 154 21 577 30 749 15 1207-107 2267-823 2814-1902 166-327 268-637 330-1001 38-227 48-384 42-662-8-348-44-590-126-831-23-66-41-126-41-132 0-10 184-13 890-13 844 0 890 1 899 18 27 50 88 452 110 725 14 162 14 624 1 782-59 703-233 1323-545 1945-481 956-1313 1788-2270 2268-620 310-1239 483-1940 542-165 14-669 10-840-5z"/><path d="M2519 3815c-391-66-725-336-868-703-79-201-96-462-45-677 83-344 338-641 666-774 116-47 205-69 330-80 412-39 811 153 1040 5e2 193 292 240 648 128 981-135 403-492 699-914 757-1e2 14-241 12-337-4z"/></g></svg></a><p class=footnote>powered by <a target=_blank href=https://gohugo.io>Hugo</a> | themed with <a target=_blank href=https://github.com/lukeorth/poison>poison</a><br>&copy; 2024 . All rights reserved.</p></div></aside><main class="content container"><div class=post><div class=info><h1 class=post-title><a href=https://gosang.github.io/posts/dotnet/exploring-graphql-with-dotnet-core/>Exploring GraphQL With .NET Core</a></h1><time datetime=2021-05-27T18:01:02Z class=post-date>May 27, 2021</time><ul class=tags><li class="tag-ASP.Net Core"><a href=https://gosang.github.io/tags/asp.net-core>ASP.Net Core</a></li></ul></div><h1 id=understanding-graphql>Understanding GraphQL</h1><p>GraphQL, developed by Facebook, is a query language for APIs that provides a more efficient, flexible, and powerful alternative to traditional REST APIs. Released in 2015, GraphQL allows clients to request exactly the data they need, addressing common issues associated with REST, such as over-fetching and under-fetching of data.</p><h2 id=why-graphql>Why GraphQL?</h2><p>The primary goal of GraphQL is to optimize data retrieval. Traditional REST APIs often force clients to accept fixed responses, leading to over-fetching (receiving more data than necessary) or under-fetching (not receiving enough data, necessitating multiple requests). GraphQL addresses these issues by empowering clients to define the structure of the response.</p><h2 id=problems-resolved-by-graphql>Problems Resolved by GraphQL</h2><ul><li><strong>Over-fetching</strong>: Clients receive more data than needed.</li><li><strong>Under-fetching</strong>: Clients make multiple requests for related data.</li><li><strong>Versioning</strong>: Eliminates the need for versioning since clients request specific fields.</li></ul><h1 id=graphql-vs-web-api>GraphQL vs. Web API</h1><p>While traditional REST APIs expose fixed endpoints with predefined responses, GraphQL provides a dynamic, client-driven approach. In REST, the server dictates the response structure, whereas GraphQL enables clients to request only the fields they require. This reduces unnecessary data transfer and enhances efficiency.</p><h1 id=graphql-in-microservices-or-modular-monolithic-systems>GraphQL in Microservices or Modular Monolithic Systems</h1><p>In the context of microservices or modular monolithic systems, GraphQL acts as a unified API layer. Clients can efficiently retrieve data from multiple services with a single query, making it an ideal solution for aggregating information from various sources. Its flexibility also supports the dynamic requirements of modular architectures.</p><h1 id=implementing-graphql-with-aspnet-core-and-entity-framework-core>Implementing GraphQL with ASP.NET Core and Entity Framework Core</h1><p>Let&rsquo;s dive into implementing GraphQL in the context of an e-commerce system using .NET Core, MediatR, AutoMapper, Entity Framework Core, and xUnit for unit tests.</p><h2 id=local-environment-setup>Local Environment Setup</h2><ol><li>Create a .NET Core API Project:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>dotnet new web -n ECommerceGraphQL
</span></span><span style=display:flex><span>cd ECommerceGraphQL
</span></span></code></pre></div><ol start=2><li>Install Required Packages:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>dotnet add package GraphQL
</span></span><span style=display:flex><span>dotnet add package GraphQL.Server.Transports.AspNetCore
</span></span><span style=display:flex><span>dotnet add package MediatR
</span></span><span style=display:flex><span>dotnet add package AutoMapper.Extensions.Microsoft.DependencyInjection
</span></span><span style=display:flex><span>dotnet add package Microsoft.EntityFrameworkCore.SqlServer
</span></span><span style=display:flex><span>dotnet add package Microsoft.EntityFrameworkCore.Design
</span></span><span style=display:flex><span>dotnet add package xunit
</span></span></code></pre></div><ol start=3><li>Implement Database Models, MediatR Handlers, and AutoMapper Profiles.</li></ol><ul><li>Create Database Models</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>// Product.cs</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Product</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> Id { <span style=color:#66d9ef>get</span>; <span style=color:#66d9ef>set</span>; }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> Name { <span style=color:#66d9ef>get</span>; <span style=color:#66d9ef>set</span>; }
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Other properties</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Order.cs</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Order</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> Id { <span style=color:#66d9ef>get</span>; <span style=color:#66d9ef>set</span>; }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> ProductId { <span style=color:#66d9ef>get</span>; <span style=color:#66d9ef>set</span>; }
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Other properties</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ul><li>Configure Entity Framework Core</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>// ApplicationDbContext.cs</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ApplicationDbContext</span> : DbContext
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> ApplicationDbContext(DbContextOptions&lt;ApplicationDbContext&gt; options) : <span style=color:#66d9ef>base</span>(options) { }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> DbSet&lt;Product&gt; Products { <span style=color:#66d9ef>get</span>; <span style=color:#66d9ef>set</span>; }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> DbSet&lt;Order&gt; Orders { <span style=color:#66d9ef>get</span>; <span style=color:#66d9ef>set</span>; }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ul><li>Implement MediatR Handlers</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>// GetProductQuery.cs</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>GetProductQuery</span> : IRequest&lt;Product&gt;
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> ProductId { <span style=color:#66d9ef>get</span>; <span style=color:#66d9ef>set</span>; }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// GetProductHandler.cs</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>GetProductHandler</span> : IRequestHandler&lt;GetProductQuery, Product&gt;
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> ApplicationDbContext _context;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> GetProductHandler(ApplicationDbContext context)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        _context = context;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>async</span> Task&lt;Product&gt; Handle(GetProductQuery request, CancellationToken cancellationToken)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>await</span> _context.Products.FindAsync(request.ProductId);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ul><li>Configure AutoMapper</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>// AutoMapperProfile.cs</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AutoMapperProfile</span> : Profile
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> AutoMapperProfile()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        CreateMap&lt;Product, ProductModel&gt;();
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Other mappings</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=4><li>Implement GraphQL Schema and Configure ASP.NET Core to Use GraphQL</li></ol><ul><li>Implement GraphQL Schema</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>// GraphQLSchema.cs</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ECommerceSchema</span> : Schema
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> ECommerceSchema(IServiceProvider serviceProvider) : <span style=color:#66d9ef>base</span>(serviceProvider)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        Query = serviceProvider.GetRequiredService&lt;ECommerceQuery&gt;();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ECommerceQuery.cs</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ECommerceQuery</span> : ObjectGraphType
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> ECommerceQuery(IMediator mediator)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        FieldAsync&lt;ProductModel&gt;(
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;product&#34;</span>,
</span></span><span style=display:flex><span>            arguments: <span style=color:#66d9ef>new</span> QueryArguments(<span style=color:#66d9ef>new</span> QueryArgument&lt;IntGraphType&gt; { Name = <span style=color:#e6db74>&#34;productId&#34;</span> }),
</span></span><span style=display:flex><span>            resolve: <span style=color:#66d9ef>async</span> context =&gt;
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>var</span> productId = context.GetArgument&lt;<span style=color:#66d9ef>int</span>&gt;(<span style=color:#e6db74>&#34;productId&#34;</span>);
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>await</span> mediator.Send(<span style=color:#66d9ef>new</span> GetProductQuery { ProductId = productId });
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ProductModel.cs</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ProductModel</span> : ObjectGraphType&lt;Product&gt;
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> ProductModel()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        Field(p =&gt; p.Id);
</span></span><span style=display:flex><span>        Field(p =&gt; p.Name);
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Other fields</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ul><li>Configure ASP.NET Core to Use GraphQL</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>// Startup.cs</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Startup</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> ConfigureServices(IServiceCollection services)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Other configurations</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        services.AddDbContext&lt;ApplicationDbContext&gt;(options =&gt;
</span></span><span style=display:flex><span>            options.UseSqlServer(Configuration.GetConnectionString(<span style=color:#e6db74>&#34;DefaultConnection&#34;</span>)));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        services.AddMediatR(<span style=color:#66d9ef>typeof</span>(Startup));
</span></span><span style=display:flex><span>        services.AddAutoMapper(<span style=color:#66d9ef>typeof</span>(Startup));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        services.AddScoped&lt;ECommerceSchema&gt;();
</span></span><span style=display:flex><span>        services.AddScoped&lt;ECommerceQuery&gt;();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        services.AddGraphQL(options =&gt;
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            options.ExposeExceptions = <span style=color:#66d9ef>true</span>; <span style=color:#75715e>// Set to false in production</span>
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>        .AddSystemTextJson()
</span></span><span style=display:flex><span>        .AddGraphTypes(ServiceLifetime.Scoped);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> Configure(IApplicationBuilder app, IWebHostEnvironment env)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Other configurations</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        app.UseGraphQL&lt;ECommerceSchema&gt;();
</span></span><span style=display:flex><span>        app.UseGraphQLPlayground(<span style=color:#66d9ef>new</span> GraphQLPlaygroundOptions());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=5><li>Unit Testing with xUnit</li></ol><p>A Sample Product Unit Tests:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>// ProductTests.cs</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ProductTests</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span><span style=color:#a6e22e>    [Fact]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>async</span> Task CanGetProductById()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Setup and arrange</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> dbContextOptions = <span style=color:#66d9ef>new</span> DbContextOptionsBuilder&lt;ApplicationDbContext&gt;()
</span></span><span style=display:flex><span>            .UseInMemoryDatabase(<span style=color:#e6db74>&#34;InMemoryDatabase&#34;</span>)
</span></span><span style=display:flex><span>            .Options;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>using</span> var context = <span style=color:#66d9ef>new</span> ApplicationDbContext(dbContextOptions);
</span></span><span style=display:flex><span>        context.Products.Add(<span style=color:#66d9ef>new</span> Product { Id = <span style=color:#ae81ff>1</span>, Name = <span style=color:#e6db74>&#34;TestProduct&#34;</span> });
</span></span><span style=display:flex><span>        context.SaveChanges();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> mediator = <span style=color:#66d9ef>new</span> Mock&lt;IMediator&gt;();
</span></span><span style=display:flex><span>        mediator.Setup(x =&gt; x.Send(It.IsAny&lt;GetProductQuery&gt;(), <span style=color:#66d9ef>default</span>(CancellationToken)))
</span></span><span style=display:flex><span>            .ReturnsAsync(<span style=color:#66d9ef>new</span> Product { Id = <span style=color:#ae81ff>1</span>, Name = <span style=color:#e6db74>&#34;TestProduct&#34;</span> });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> handler = <span style=color:#66d9ef>new</span> GetProductHandler(context);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> query = <span style=color:#66d9ef>new</span> GetProductQuery { ProductId = <span style=color:#ae81ff>1</span> };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Act</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> result = <span style=color:#66d9ef>await</span> handler.Handle(query, <span style=color:#66d9ef>default</span>(CancellationToken));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Assert</span>
</span></span><span style=display:flex><span>        Assert.NotNull(result);
</span></span><span style=display:flex><span>        Assert.Equal(<span style=color:#e6db74>&#34;TestProduct&#34;</span>, result.Name);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=6><li>Docker and Docker Compose Files</li></ol><ul><li>A sample Dockerfile:</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#ae81ff>FROM mcr.microsoft.com/dotnet/core/sdk:6.0 AS build</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>WORKDIR /src</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>COPY . .</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>RUN dotnet build -c Release -o /app</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>FROM build AS publish</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>RUN dotnet publish -c Release -o /app</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>FROM mcr.microsoft.com/dotnet/core/aspnet:3.1 AS final</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>WORKDIR /app</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>COPY --from=publish /app .</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>ENTRYPOINT [&#34;dotnet&#34;, &#34;ECommerceGraphQL.dll&#34;]</span>
</span></span></code></pre></div><ul><li>A sample docker-compose.yaml:</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>version</span>: <span style=color:#e6db74>&#34;3.4&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>services</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>ecommercegraphql</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>image</span>: <span style=color:#ae81ff>ecommercegraphql</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>build</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>context</span>: <span style=color:#ae81ff>.</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>dockerfile</span>: <span style=color:#ae81ff>Dockerfile</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;5000:80&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>environment</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>ASPNETCORE_ENVIRONMENT=Development</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>ASPNETCORE_URLS=http://+:80</span>
</span></span></code></pre></div><ol start=6><li>Running and Debugging in Docker Deskto</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker-compose up --build
</span></span></code></pre></div><p>Note: The code snippets provided are placeholders. Actual code implementation may vary based on specific project requirements.</p><h1 id=advantages-and-disadvantages-of-graphql>Advantages and Disadvantages of GraphQL</h1><h2 id=advantages>Advantages</h2><ul><li><strong>Flexible Queries</strong>: Clients request only the data they need.</li><li><strong>Reduced Over-fetching</strong>: Minimizes data transfer and optimizes bandwidth.</li><li><strong>Single Endpoint</strong>: GraphQL provides a single endpoint for all data needs.</li><li><strong>Introspection</strong>: Enables clients to discover available types and queries.</li></ul><h2 id=disadvantages>Disadvantages</h2><ul><li>Learning Curve: GraphQL has a steeper learning curve.</li><li>Security Concerns: Over-fetching or large queries may pose security risks.</li><li>Tooling Support: While improving, tooling support may not be as extensive as REST.</li></ul><h1 id=issues-and-considerations-for-graphql>Issues and Considerations for GraphQL</h1><ul><li><strong>Security</strong>: Implement proper authentication and authorization to prevent unauthorized access and malicious queries.</li><li><strong>Performance</strong>: Be mindful of query complexity and depth to avoid performance degradation.</li><li><strong>N+1 Query Problem</strong>: Address potential N+1 query issues by optimizing data fetching strategies.</li></ul><h1 id=when-to-use-graphql-and-use-cases>When to Use GraphQL and Use Cases</h1><p>Use GraphQL When:</p><ul><li><strong>Complex Data Requirements</strong>: Your application has complex data relationships.</li><li><strong>Mobile Applications</strong>: Optimizing data transfer is crucial for mobile app performance.</li><li><strong>Microservices Architecture</strong>: Aggregating data from multiple services is a common requirement.</li><li><strong>Dynamic UIs</strong>: UI components require varying sets of data.</li></ul><p>Use Cases/Scenarios:</p><ul><li><strong>E-commerce Systems</strong>: Displaying product details, customer information, and order history.</li><li><strong>Social Media Platforms</strong>: Fetching user profiles, posts, comments, and related data.</li><li><strong>Analytics Platforms</strong>: Aggregating and querying diverse data sources for analytics.</li></ul><h1 id=when-not-to-use-graphql>When Not to Use GraphQL</h1><ul><li><strong>Simple APIs</strong>: For straightforward APIs where over-fetching and under-fetching are not significant concerns.</li><li><strong>Legacy Systems</strong>: Retrofitting GraphQL into legacy systems may not be practical in some cases.</li></ul><h1 id=best-practices>Best Practices</h1><ul><li><strong>Versioning</strong>: Include versioning in your schema to handle changes gracefully.</li><li><strong>Caching</strong>: Implement caching strategies to optimize repeated queries.</li><li><strong>Security</strong>: Secure your GraphQL endpoint to prevent malicious queries.</li><li><strong>Documentation</strong>: Provide comprehensive documentation for your GraphQL schema.</li><li><strong>Testing</strong>: Write unit tests for your GraphQL queries and mutations.</li></ul><h1 id=conclusion>Conclusion</h1><p>GraphQL, when implemented with ASP.NET Core and Entity Framework Core, offers a powerful solution for developing flexible and efficient APIs. Understanding the advantages, disadvantages, issues, and best practices is crucial for successful adoption. Whether in a microservices architecture or a modular monolithic system, GraphQL shines in providing a unified and dynamic approach to data retrieval.</p><h1 id=references>References:</h1><ul><li><a href=https://graphql.org/ target=_blank>GraphQL Documentation</a></li><li><a href=https://learn.microsoft.com/en-us/aspnet/core/introduction-to-aspnet-core target=_blank>ASP.NET Core Documentation</a></li><li><a href=https://learn.microsoft.com/en-us/ef/core/ target=_blank>Entity Framework Core Documentation</a></li><li><a href=https://github.com/jbogard/MediatR target=_blank>MediatR Library</a></li><li><a href=https://docs.automapper.org/en/stable/ target=_blank>AutoMapper Documentation</a></li></ul><hr><div class=footer><a class=previous-post href="https://gosang.github.io/posts/devops/modern-devops-branching-strategies-a-guide-to-efficient-development-workflows/?ref=footer"><span style=font-weight:700>« Previous</span><br>Modern Devops Branching Strategies: a Guide to...</a><div class=next-post><a href="https://gosang.github.io/posts/design-patterns/structural/proxy-pattern/?ref=footer"><span style=font-weight:700>Next »</span><br>Proxy Pattern</a></div></div></div></main><div class=article-toc><div class=toc-wrapper><h4 id=contents></h4><nav id=TableOfContents><ul><li><a href=#why-graphql>Why GraphQL?</a></li><li><a href=#problems-resolved-by-graphql>Problems Resolved by GraphQL</a></li></ul><ul><li><a href=#local-environment-setup>Local Environment Setup</a></li></ul><ul><li><a href=#advantages>Advantages</a></li><li><a href=#disadvantages>Disadvantages</a></li></ul></nav></div></div></div></body></html>