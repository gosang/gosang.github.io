<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en-us lang=en-us><head><script defer language=javascript type=text/javascript src=/js/bundle.min.11d62625e7495f8147fccf5d08f37bded574a50c4508c235cc666848567d99ab.js></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=/favicon.png><title itemprop=name>Go Sang - Implementing Pagination with MongoDB C# Driver in ASP.NET Core 8</title><meta property="og:title" content="Go Sang - Implementing Pagination with MongoDB C# Driver in ASP.NET Core 8"><meta name=twitter:title content="Go Sang - Implementing Pagination with MongoDB C# Driver in ASP.NET Core 8"><meta itemprop=name content="Go Sang - Implementing Pagination with MongoDB C# Driver in ASP.NET Core 8"><meta name=application-name content="Go Sang - Implementing Pagination with MongoDB C# Driver in ASP.NET Core 8"><meta property="og:site_name" content><meta name=description content><meta itemprop=description content><meta property="og:description" content><meta name=twitter:description content><base href=https://gosang.github.io/posts/dotnet/implementing-pagination-with-mongodb-csharp-driver-in-asp-dotnet-core/><link rel=canonical href=https://gosang.github.io/posts/dotnet/implementing-pagination-with-mongodb-csharp-driver-in-asp-dotnet-core/ itemprop=url><meta name=url content="https://gosang.github.io/posts/dotnet/implementing-pagination-with-mongodb-csharp-driver-in-asp-dotnet-core/"><meta name=twitter:url content="https://gosang.github.io/posts/dotnet/implementing-pagination-with-mongodb-csharp-driver-in-asp-dotnet-core/"><meta property="og:url" content="https://gosang.github.io/posts/dotnet/implementing-pagination-with-mongodb-csharp-driver-in-asp-dotnet-core/"><meta property="og:updated_time" content="2003-02-12T327:06:25+0100"><link rel=sitemap type=application/xml title=Sitemap href=https://gosang.github.io/sitemap.xml><meta name=robots content="index,follow"><meta name=googlebot content="index,follow"><meta name=twitter:site content><meta name=twitter:creator content><meta property="fb:admins" content><meta name=apple-mobile-web-app-title content><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black"><meta property="og:type" content="article"><meta property="article:publisher" content><meta property="og:article:published_time" content="2003-02-12T327:06:25+0100"><meta property="article:published_time" content="2003-02-12T327:06:25+0100"><script defer type=application/ld+json>{"@context":"http://schema.org","@type":"Article","headline":"Implementing Pagination with MongoDB C# Driver in ASP.NET Core 8","author":{"@type":"Person","name":"https:\/\/github.com\/gosang"},"datePublished":"2025-03-02","description":"","wordCount":"1193","mainEntityOfPage":"True","dateModified":"2025-03-02","image":{"@type":"imageObject","url":""},"publisher":{"@type":"Organization","name":"","logo":{"@type":"imageObject","url":""}}}</script><meta name=generator content="Hugo 0.119.0"><link type=text/css rel=stylesheet href=/css/bundle.min.178e339ccb9acabffeebf9adbb0bb23c1ec0b72a2a50edee18a5007d4d5a68aa.css><style>body{--sidebar-bg-color:#202020;--sidebar-img-border-color:#515151;--sidebar-p-color:#909090;--sidebar-h1-color:#FFF;--sidebar-a-color:#FFF;--sidebar-socials-color:#FFF;--text-color:#222;--bkg-color:#FAF9F6;--post-title-color:#303030;--list-color:#5a5a5a;--link-color:#268bd2;--date-color:#515151;--table-border-color:#E5E5E5;--table-stripe-color:#F9F9F9;--code-color:#bf616a;--code-background-color:#E5E5E5;--moon-sun-color:#FFF;--moon-sun-background-color:#515151}body.dark-theme{--text-color:#eee;--bkg-color:#121212;--post-title-color:#DBE2E9;--list-color:#9d9d9d;--link-color:#268bd2;--date-color:#9a9a9a;--table-border-color:#515151;--table-stripe-color:#202020;--code-color:#ff7f7f;--code-background-color:#393D47}body{background-color:var(--bkg-color)}</style></head><body><div class=wrapper><aside class=sidebar><div class="container sidebar-sticky"><div class=light-dark align=right><button class=btn-light-dark title="Toggle light/dark mode"><svg class="moon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16"><path fill="currentcolor" d="M6 .278a.768.768.0 01.08.858 7.208 7.208.0 00-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527.0 1.04-.055 1.533-.16a.787.787.0 01.81.316.733.733.0 01-.031.893A8.349 8.349.0 018.344 16C3.734 16 0 12.286.0 7.71.0 4.266 2.114 1.312 5.124.06A.752.752.0 016 .278z"/></svg><svg class="sun" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16"><path fill="currentcolor" d="M8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0zm0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13zm8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5zM3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8zm10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0zm-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0zm9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707zM4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708z"/></svg></button></div><div class=sidebar-about><h1 class=brand><a href=https://gosang.github.io/><h1>Go Sang</h1></a></h1><p class=lead>Learning about technology.</p></div><nav><ul class=sidebar-nav><li class=heading><a href=/posts/>Posts</a></li><li class=sub-heading>Recent</li><li class=bullet><a href=https://gosang.github.io/posts/caching/implementing-distributed-caching-in-asp-dotnet-core-with-redis/>Implementing Distributed Caching in ASP.NET Core with Redis</a></li><li class=bullet><a href=https://gosang.github.io/posts/ai/implementing-model-context-protocol-for-large-language-models/>Implementing Model Context Protocol for Large Language Models</a></li><li class=bullet><a href=https://gosang.github.io/posts/ai/retrieval-augmented-generation-architecture-patterns/>Retrieval Augmented Generation Architecture Patterns</a></li><li class=bullet><a href=https://gosang.github.io/posts/dotnet/implementing-range-based-pagination-with-mongodb-csharp-driver-in-asp-dotnet-core/>Implementing Range-Based Pagination with MongoDB C# Driver in ASP.NET Core 8</a></li><li class=bullet><a href=https://gosang.github.io/posts/dotnet/implementing-pagination-with-mongodb-csharp-driver-in-asp-dotnet-core/>Implementing Pagination with MongoDB C# Driver in ASP.NET Core 8</a></li></ul></nav><a target=_blank class=social title=GitHub href=https://github.com/gosang><svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="-2 -2 24 24"><path fill="currentcolor" d="M18.88 1.099C18.147.366 17.265.0 16.233.0H3.746C2.714.0 1.832.366 1.099 1.099.366 1.832.0 2.714.0 3.746v12.487c0 1.032.366 1.914 1.099 2.647.733.733 1.615 1.099 2.647 1.099H6.66c.19.0.333-.007.429-.02a.504.504.0 00.286-.169c.095-.1.143-.245.143-.435l-.007-.885c-.004-.564-.006-1.01-.006-1.34l-.3.052c-.19.035-.43.05-.721.046a5.555 5.555.0 01-.904-.091 2.026 2.026.0 01-.872-.39 1.651 1.651.0 01-.572-.8l-.13-.3a3.25 3.25.0 00-.41-.663c-.186-.243-.375-.407-.566-.494l-.09-.065a.956.956.0 01-.17-.156.723.723.0 01-.117-.182c-.026-.061-.004-.111.065-.15.07-.04.195-.059.378-.059l.26.04c.173.034.388.138.643.311a2.1 2.1.0 01.631.677c.2.355.44.626.722.813.282.186.566.28.852.28.286.0.533-.022.742-.065a2.59 2.59.0 00.585-.196c.078-.58.29-1.028.637-1.34a8.907 8.907.0 01-1.333-.234 5.314 5.314.0 01-1.223-.507 3.5 3.5.0 01-1.047-.872c-.277-.347-.505-.802-.683-1.365-.177-.564-.266-1.215-.266-1.952.0-1.049.342-1.942 1.027-2.68-.32-.788-.29-1.673.091-2.652.252-.079.625-.02 1.119.175.494.195.856.362 1.086.5.23.14.414.257.553.352a9.233 9.233.0 012.497-.338c.859.0 1.691.113 2.498.338l.494-.312a6.997 6.997.0 011.197-.572c.46-.174.81-.221 1.054-.143.39.98.424 1.864.103 2.653.685.737 1.028 1.63 1.028 2.68.0.737-.089 1.39-.267 1.957-.177.568-.407 1.023-.689 1.366a3.65 3.65.0 01-1.053.865c-.42.234-.828.403-1.223.507a8.9 8.9.0 01-1.333.235c.45.39.676 1.005.676 1.846v3.11c0 .147.021.266.065.357a.36.36.0 00.208.189c.096.034.18.056.254.064.074.01.18.013.318.013h2.914c1.032.0 1.914-.366 2.647-1.099.732-.732 1.099-1.615 1.099-2.647V3.746c0-1.032-.367-1.914-1.1-2.647z"/></svg></a><a target=_blank class=social title="RSS Feed" href=https://gosang.github.io//posts/index.xml><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 1280 1280"><g transform="translate(0.000000,1280.000000) scale(0.100000,-0.100000)" fill="currentcolor"><path d="M2295 11929c-284-12-642-45-707-65-17-5-18-63-18-1039 0-569 4-1036 8-1039 5-3 74 6 153 19 510 86 1168 95 1789 25 1348-153 2602-677 3670-1531 385-308 820-744 1126-1129 842-1060 1362-2313 1514-3650 70-621 61-1279-25-1789-13-79-22-148-19-153 3-4 471-8 1039-8h1035l5 23c51 225 85 942 67 1419-23 605-77 1044-198 1617-294 14e2-927 2734-1823 3846-1043 1295-2364 2259-3909 2854-1158 447-2451 656-3707 6e2z"/><path d="M2255 7845c-269-25-620-81-667-106-17-9-18-55-18-899 0-706 3-890 13-890 6 0 66 18 132 41 130 44 288 79 467 105 154 21 577 30 749 15 1207-107 2267-823 2814-1902 166-327 268-637 330-1001 38-227 48-384 42-662-8-348-44-590-126-831-23-66-41-126-41-132 0-10 184-13 890-13 844 0 890 1 899 18 27 50 88 452 110 725 14 162 14 624 1 782-59 703-233 1323-545 1945-481 956-1313 1788-2270 2268-620 310-1239 483-1940 542-165 14-669 10-840-5z"/><path d="M2519 3815c-391-66-725-336-868-703-79-201-96-462-45-677 83-344 338-641 666-774 116-47 205-69 330-80 412-39 811 153 1040 5e2 193 292 240 648 128 981-135 403-492 699-914 757-1e2 14-241 12-337-4z"/></g></svg></a><p class=footnote>powered by <a target=_blank href=https://gohugo.io>Hugo</a> | themed with <a target=_blank href=https://github.com/lukeorth/poison>poison</a><br>&copy; 2025 . All rights reserved.</p></div></aside><main class="content container"><div class=post><div class=info><h1 class=post-title><a href=https://gosang.github.io/posts/dotnet/implementing-pagination-with-mongodb-csharp-driver-in-asp-dotnet-core/>Implementing Pagination with MongoDB C# Driver in ASP.NET Core 8</a></h1><time datetime=2025-03-02T12:27:06+0100 class=post-date>March 2, 2025</time><ul class=tags><li class=tag-Pagination><a href=https://gosang.github.io/tags/pagination>Pagination</a></li><li class=tag-MongoDB><a href=https://gosang.github.io/tags/mongodb>MongoDB</a></li><li class="tag-ASP.NET Core"><a href=https://gosang.github.io/tags/asp.net-core>ASP.NET Core</a></li></ul></div><p>Pagination is a crucial aspect of application development, especially when dealing with large datasets in databases. It ensures that data is fetched in manageable chunks, improving performance and user experience. In this blog, we’ll explore how to implement pagination using the MongoDB C# driver in an ASP.NET Core 8 API project. We’ll cover the key concepts, functions, and best practices while discussing when and when not to use pagination.</p><h1 id=what-is-pagination>What is Pagination?</h1><p>Pagination refers to the process of dividing a dataset into discrete pages. When querying large databases, fetching all records at once can be resource-intensive. Pagination helps limit the number of records returned, making the system more scalable, responsive, and user-friendly.</p><p>In MongoDB, pagination is commonly implemented using a combination of the <code>skip</code> and <code>limit</code> functions in conjunction with sorting mechanisms to ensure the data is retrieved in a consistent order.</p><h2 id=why-pagination>Why Pagination?</h2><ul><li><p><strong>Performance</strong>: Querying large datasets can cause performance bottlenecks. Pagination limits the number of records returned at a time, improving API response time.</p></li><li><p><strong>Usability</strong>: Returning large amounts of data in a single response can overwhelm the user interface. Pagination enhances user experience by showing data in smaller, manageable chunks.</p></li><li><p><strong>Scalability</strong>: As datasets grow, pagination helps scale the system efficiently by controlling resource utilization.</p></li></ul><h1 id=key-concepts-of-pagination-with-mongodb-c-driver>Key Concepts of Pagination with MongoDB C# Driver</h1><ul><li><strong><code>skip</code></strong>: The <code>skip</code> function is used to skip a certain number of records in a dataset. This is helpful when moving to subsequent pages.</li><li><strong><code>limit</code></strong>: The <code>limit</code> function is used to specify the maximum number of records to return in a query result. It defines the size of the page.</li><li><strong>Sorting</strong>: Pagination often requires a stable sort order to ensure consistency across pages. Without sorting, records may be returned in arbitrary order, which can lead to inconsistencies when paginating.</li><li><strong>Filters</strong>: You can apply filtering conditions to ensure that the paginated results meet specific criteria before being returned.</li><li><strong>Page Number and Page Size</strong>: These parameters dictate which page of the data is returned and how many records should be included on each page.</li></ul><h1 id=implementing-pagination-in-aspnet-core-with-mongodb-c-driver>Implementing Pagination in ASP.NET Core with MongoDB C# Driver</h1><p>Let’s walk through a step-by-step implementation of pagination in a sample ASP.NET Core 8 API project that uses MongoDB as the data store.</p><h2 id=setting-up-mongodb-and-aspnet-core-8>Setting up MongoDB and ASP.NET Core 8</h2><p><strong>Step 1: Install Dependencies</strong>
First, install the necessary NuGet packages:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>dotnet add package MongoDB.Driver
</span></span><span style=display:flex><span>dotnet add package Microsoft.AspNetCore.Mvc.NewtonsoftJson
</span></span></code></pre></div><p><strong>Step 2: Set Up MongoDB in ASP.NET Core</strong>
You’ll need to configure MongoDB in your <code>appsettings.json</code> and register the MongoDB client in the <code>Program.cs</code> file.</p><p><strong>appsettings.json</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;MongoDBSettings&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;ConnectionString&#34;</span>: <span style=color:#e6db74>&#34;mongodb://localhost:27017&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;DatabaseName&#34;</span>: <span style=color:#e6db74>&#34;SampleDB&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Program.cs</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#66d9ef>var</span> builder = WebApplication.CreateBuilder(args);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>builder.Services.Configure&lt;MongoDBSettings&gt;(
</span></span><span style=display:flex><span>    builder.Configuration.GetSection(<span style=color:#e6db74>&#34;MongoDBSettings&#34;</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>builder.Services.AddSingleton&lt;IMongoClient, MongoClient&gt;(sp =&gt;
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> settings = sp.GetRequiredService&lt;IOptions&lt;MongoDBSettings&gt;&gt;().Value;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> MongoClient(settings.ConnectionString);
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>builder.Services.AddControllers()
</span></span><span style=display:flex><span>    .AddNewtonsoftJson(options =&gt;
</span></span><span style=display:flex><span>        options.SerializerSettings.ReferenceLoopHandling = Newtonsoft.Json.ReferenceLoopHandling.Ignore);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> app = builder.Build();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>app.MapControllers();
</span></span><span style=display:flex><span>app.Run();
</span></span></code></pre></div><p><strong>Step 3: Create the MongoDB Repository</strong>
Create a repository to handle the MongoDB interaction logic, including paginated queries.</p><p><strong>MongoDBRepository.cs:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MongoDBRepository</span>&lt;T&gt;
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> IMongoCollection&lt;T&gt; _collection;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> MongoDBRepository(IMongoClient client, <span style=color:#66d9ef>string</span> dbName, <span style=color:#66d9ef>string</span> collectionName)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> database = client.GetDatabase(dbName);
</span></span><span style=display:flex><span>        _collection = database.GetCollection&lt;T&gt;(collectionName);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>async</span> Task&lt;List&lt;T&gt;&gt; GetPaginatedAsync(<span style=color:#66d9ef>int</span> pageNumber, <span style=color:#66d9ef>int</span> pageSize, FilterDefinition&lt;T&gt;? filter = <span style=color:#66d9ef>null</span>, SortDefinition&lt;T&gt;? sort = <span style=color:#66d9ef>null</span>)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (filter == <span style=color:#66d9ef>null</span>)
</span></span><span style=display:flex><span>            filter = Builders&lt;T&gt;.Filter.Empty;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (sort == <span style=color:#66d9ef>null</span>)
</span></span><span style=display:flex><span>            sort = Builders&lt;T&gt;.Sort.Ascending(<span style=color:#e6db74>&#34;_id&#34;</span>); <span style=color:#75715e>// Ensure a stable sort order</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>await</span> _collection
</span></span><span style=display:flex><span>            .Find(filter)
</span></span><span style=display:flex><span>            .Sort(sort)
</span></span><span style=display:flex><span>            .Skip((pageNumber - <span style=color:#ae81ff>1</span>) * pageSize)
</span></span><span style=display:flex><span>            .Limit(pageSize)
</span></span><span style=display:flex><span>            .ToListAsync();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>async</span> Task&lt;<span style=color:#66d9ef>long</span>&gt; GetTotalCountAsync(FilterDefinition&lt;T&gt;? filter = <span style=color:#66d9ef>null</span>)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (filter == <span style=color:#66d9ef>null</span>)
</span></span><span style=display:flex><span>            filter = Builders&lt;T&gt;.Filter.Empty;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>await</span> _collection.CountDocumentsAsync(filter);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Step 4: Create an API Controller for Pagination</strong>
Now, let&rsquo;s create a controller that exposes an API endpoint for paginated data retrieval.</p><p><strong>SampleController.cs:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#a6e22e>[ApiController]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>[Route(&#34;api/[controller]</span><span style=color:#e6db74>&#34;)]
</span></span></span><span style=display:flex><span><span style=color:#e6db74></span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SampleController</span> : ControllerBase
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> MongoDBRepository&lt;MyDataModel&gt; _repository;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> SampleController(MongoDBRepository&lt;MyDataModel&gt; repository)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        _repository = repository;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span><span style=color:#a6e22e>
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>    [HttpGet(&#34;paginated&#34;)]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>async</span> Task&lt;IActionResult&gt; GetPaginatedData([FromQuery] <span style=color:#66d9ef>int</span> pageNumber = <span style=color:#ae81ff>1</span>, [FromQuery] <span style=color:#66d9ef>int</span> pageSize = <span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (pageNumber &lt;= <span style=color:#ae81ff>0</span> || pageSize &lt;= <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> BadRequest(<span style=color:#e6db74>&#34;Page number and page size must be greater than 0.&#34;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> data = <span style=color:#66d9ef>await</span> _repository.GetPaginatedAsync(pageNumber, pageSize);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> totalRecords = <span style=color:#66d9ef>await</span> _repository.GetTotalCountAsync();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> response = <span style=color:#66d9ef>new</span>
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            TotalRecords = totalRecords,
</span></span><span style=display:flex><span>            PageNumber = pageNumber,
</span></span><span style=display:flex><span>            PageSize = pageSize,
</span></span><span style=display:flex><span>            Data = data
</span></span><span style=display:flex><span>        };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> Ok(response);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>In this controller, we expose a GET endpoint /api/sample/paginated that accepts two query parameters: pageNumber and pageSize. The response includes the total number of records, the current page, the page size, and the actual data returned by MongoDB.</p><p><strong>Step 5: Run the Application</strong>
Now that the implementation is complete, you can run the application and query the paginated data.</p><p><strong>Example query:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>GET http://localhost:5000/api/sample/paginated?pageNumber<span style=color:#f92672>=</span>2&amp;pageSize<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>
</span></span></code></pre></div><p>This would return the second page of data with 5 records per page.</p><h1 id=advantage-and-disadvantage>Advantage and Disadvantage</h1><table><thead><tr><th>Advantage</th><th>Disadvantage</th></tr></thead><tbody><tr><td>✅ Performance Optimization: Fetching a limited number of records at a time reduces the load on both the server and the client.</td><td>❌ Complexity: Pagination introduces additional complexity into your queries, requiring careful management of page numbers and sizes.</td></tr><tr><td>✅ Memory Efficiency: By avoiding large result sets, you minimize memory consumption, improving the efficiency of your API.</td><td>❌ Inconsistent Data: When working with dynamic datasets (frequent inserts/updates), pages can become inconsistent as new records might shift previously retrieved pages.</td></tr><tr><td>✅ Improved User Experience: End-users get a faster, more responsive experience, with data presented in small, manageable chunks.</td><td>❌ Performance with Skip : MongoDB’s skip function can be inefficient for large offsets, especially as the number of skipped documents increases, since MongoDB must walk through skipped records.</td></tr></tbody></table><h1 id=when-to-use-pagination>When to Use Pagination</h1><ul><li><p><strong>Large Datasets</strong>: If your application deals with a large dataset where returning all records at once would be impractical.</p></li><li><p><strong>User Interfaces</strong>: For interfaces where users browse data in lists or tables and need the ability to navigate through pages.</p></li><li><p><strong>APIs Serving Multiple Clients</strong>: In situations where different clients may need different subsets of data (e.g., mobile apps, web apps).</p></li></ul><h1 id=when-not-to-use-pagination>When Not to Use Pagination</h1><ul><li><p><strong>Small Datasets</strong>: If your dataset is small, pagination may introduce unnecessary complexity.</p></li><li><p><strong>Real-Time Data</strong>: When working with real-time systems where data is frequently updated, pagination may lead to inconsistent results.</p></li></ul><h1 id=issues-considerations-and-best-practices>Issues, Considerations, and Best Practices</h1><ul><li><p><strong>Use Indexing</strong>: Indexing improves query performance.</p></li><li><p><strong>Efficient Pagination</strong>: Use skip and limit for small to moderate datasets. For larger datasets, consider alternatives like range queries using indexed fields (e.g., _id or date ranges) to avoid the performance cost of skip.</p></li><li><p><strong>Sort Consistency</strong>: Always ensure your query is sorted by a unique field (e.g., _id). Without sorting, pages can yield inconsistent results, especially if records are inserted or deleted during navigation.</p></li><li><p><strong>Page Size Limits</strong>: Set reasonable limits for the pageSize to avoid fetching too much data at once. For example, limit pageSize to 100 records per page.</p></li><li><p><strong>Caching</strong>: Consider caching frequent queries to reduce the load on your MongoDB instance, especially for high-traffic applications.</p></li><li><p><strong>Handling Changes</strong>: If your dataset changes frequently, consider implementing mechanisms to track consistency (e.g., using timestamps) or use snapshotting techniques to avoid inconsistent pagination.</p></li></ul><h1 id=conclusion>Conclusion</h1><p>Implementing pagination in MongoDB using the C# driver within an ASP.NET Core application enhances efficiency and scalability. While the <code>skip</code> and <code>limit</code> approach works well for small to moderate datasets, alternative techniques like range-based pagination should be considered for larger datasets.</p><p>By following best practices, you can ensure a performant and reliable pagination system that enhances both user experience and backend performance.</p><hr><div class=footer><a class=previous-post href="https://gosang.github.io/posts/react/zustand-redux-context-choosing-the-right-state-management-solution/?ref=footer"><span style=font-weight:700>« Previous</span><br>Zustand, Redux and Context: Choosing the Right...</a><div class=next-post><a href="https://gosang.github.io/posts/dotnet/implementing-range-based-pagination-with-mongodb-csharp-driver-in-asp-dotnet-core/?ref=footer"><span style=font-weight:700>Next »</span><br>Implementing Range-Based Pagination with MongoDB...</a></div></div></div></main><div class=article-toc><div class=toc-wrapper><h4 id=contents></h4><nav id=TableOfContents><ul><li><a href=#why-pagination>Why Pagination?</a></li></ul><ul><li><a href=#setting-up-mongodb-and-aspnet-core-8>Setting up MongoDB and ASP.NET Core 8</a></li></ul></nav></div></div></div></body></html>